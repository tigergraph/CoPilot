from enum import auto
import json
import os
import time
from typing import Tuple
import unittest
from app.embeddings.embedding_services import OpenAI_Embedding
from app.embeddings.milvus_embedding_store import MilvusEmbeddingStore
from app.llm_services.openai_service import OpenAI
from pymilvus import connections, utility
from app.supportai.retrievers import MilvusRetriever

collection_name = "tg_documents_test"
vector_field = "document_content"
vertex_field = "vertex_id"
vertex_id1 = "67"
vertex_id2 = "114"
connections.connect("default", host="localhost", port="19530")
utility.drop_collection(collection_name)
milvus_embedding_store = MilvusEmbeddingStore(host="localhost", port="19530", collection_name=collection_name, vector_field=vector_field, vertex_field=vertex_field)

class TestMilvusRetrieverIntegration(unittest.TestCase):

    @classmethod
    def setUpClass(cls):
        document_content1 = [
            -0.003215774151029432,-0.038147527199709964,-0.025713199395853172,-0.01050486214908593,-0.02801296635177752,0.04680088098038334,-0.021178634545915877,-0.03614659930212681,-0.01408444139356963,-0.005275168849228112,0.03269045382469427,-0.0038979080900757523,0.011927598923269863,-0.010972611455171142,0.014773071540315168,0.0002482886159163157,0.029546143080630336,0.010550337698456223,0.006308114535007701,-0.026531761147163577,-0.019957288825141414,0.008692335217820214,0.001397562426846469,-0.00597354388959908,0.006509506519739732,-0.0214255020800182,0.010069595511311293,-0.02099673048578958,0.020009262212025408,-0.006723891385531481,0.006623195393165466,0.0005830620568127701,-0.020230142121363173,-0.006464030970369438,-0.033496021763622395,0.009361475577314897,0.004927605322759772,-0.005807883026273194,-0.021503459366376508,-0.04784032636632175,0.026258907850941815,0.0005412407843443524,-0.009225048929204015,-0.002725287303089713,-0.020593948378970644,0.002507654217033035,-0.0015632235230029947,-0.02197120867246172,-0.02016517678474202,-0.019242671984953875,-0.006678415836161187,0.03414567512983391,-0.035964697104645636,-0.0034691381256616144,-0.029078393774545123,-0.014928987975676905,0.0012692563293979127,0.02692155130424536,0.02251691526490524,-0.0073020811119468565,-0.01455218976833228,-0.011154513652652315,-0.01229790022442335,-0.005106259532806657,0.014097434274629348,0.007834794823330658,-0.0017865411691462797,-0.02861064446845991,-0.026791620631003057,-0.018554042769530897,0.02614196912743667,0.0454496064490117,0.020425038131226626,0.016748010881811198,0.006918786929733653,-0.018761930729131508,-0.027207398412849398,0.006002778570475366,-0.01181066113108728,-0.0007970409823828926,0.01867097963039092,-0.021165640733533598,-0.002510902437297964,0.01915172088621329,-0.0023290000069861507,0.01271367707494713,0.014734091965813453,0.023257517867212214,-0.018502069382646903,-0.008464956539646186,-0.005012059980970499,0.01777446059272221,-0.0012790011066080213,0.003279115261102798,-0.016163324714865965,0.01642318606135057,-0.023426428114956228,0.026336865137300124,-0.010823190994677982,-0.020632926090827234,0.03674428114409945,-0.016890935367435782,-3.585770851497548e-05,-0.002033408703248604,-0.0295201573185109,-0.0043266778216592494,-0.012681194406636554,-0.036562378946618276,0.031625028264571795,-0.014708106203694017,-0.004303940046974103,0.006723891385531481,0.01285010372305801,-0.004372153371029543,-0.019125735124093855,-0.010758226589379393,0.006464030970369438,-0.03048164169280076,-0.004245471616544092,-0.025297423476651957,0.0068668144741722194,0.017319705099019277,0.017176780613394695,-0.010485372361835072,0.010875163450239415,-0.001758931064063739,-0.020425038131226626,-0.015955436755265357,0.02538837457539254,-0.008257068580045577,0.015604625241362727,0.05088069219926283,-0.007341060220787291,-0.008153124600245273,-0.02106169582241073,0.024206008429119793,-0.01119998920202261,-0.006957766038574087,-0.00995265865045127,-0.04394241734492344,0.028922477339183388,0.010524351936336787,-0.022594874413908672,-0.029546143080630336,0.005837117241488199,0.013694650305165285,0.009283517359634027,0.015552652785801294,-0.002663570419564132,-0.010322959951604756,0.023101601431850475,0.00885474762805053,0.01503293195547721,-0.019034784025353267,0.017488613484118173,-0.00556426394526644,0.00036177457743889605,0.015669589646661316,-0.022192090444444607,-0.006551733616014455,0.011934094898138441,0.016903927317172936,0.019372602658196177,-0.02710345350172653,-0.002223431800638061,0.00961484001760836,0.019385596470578456,-0.0012643838825851983,-0.011505325166554944,0.013915532077148175,-0.0007974470390198389,0.009179573379833723,-0.008893727202552245,0.033859826158584745,-0.0014324812021480812,0.00954987468098721,0.005931316793324357,-0.004381898264654972,0.0006500573855803516,-0.04212339164482146,-0.0024800439955351737,-0.00563247726932188,0.03539300661272781,0.022283041543185195,-0.02663570419564132,-0.0036640336698637865,0.002074011805806183,0.0043266778216592494,0.009842217764459826,-0.0003715193546490046,-0.007380039329627725,0.011180499414771752,0.0030127581725802564,-0.007393032210687443,-0.6519381314236081,-0.013837573859467305,0.011206485176891186,-0.020022254161762565,-0.013408804127883808,0.004206492507703658,0.005271920861793822,0.017813440167223926,-0.007925745922071245,0.012193955313300484,-0.009965651531510989,0.014565182649391998,-0.0016330610736062197,-0.032586510776216535,-0.018865875640254375,0.009692798235289228,0.00494384665691506,-0.026739649106764185,0.016397200299231134,-0.02603802607895893,-0.01725473976239813,0.03606864387841363,-0.00026209372666524623,-0.03209277570801188,0.010011127080881282,-0.0008364260896526132,0.017670515681599344,-0.024206008429119793,0.010238504827732748,0.003207653483951788,-0.010524351936336787,0.010452889693524496,0.013090474350969192,0.04051225949225546,0.03819949872394884,0.0034918759003467613,-0.03365194006162926,0.023673295649058554,0.00494384665691506,0.021594410465117096,0.013194418330769498,-0.022633852125765262,0.024387910626600968,-0.03027375187055503,-0.0005826560583834839,-0.0017069589577482665,0.031547069115568364,-0.019710421291039087,0.005859855016173346,-0.005103011079711086,-0.009212056048144299,-0.015058917717596645,-0.0029494170625068905,-0.00810115214468384,0.016722025119691765,-0.008244075698985859,0.028896491577063952,-0.011713214057478114,0.0031556814940516356,0.006600457618480319,-0.01751459924623761,0.04142177047966133,-0.007587927754889615,0.010219015971804453,-0.010043609749191856,0.02642781623604071,-0.013226900999080074,0.0004795239008187714,0.011057065647720589,-0.011407877161623217,0.03227467790549306,0.031313195393848324,-0.014188385373369933,-0.01243432687253423,0.013824580978407587,0.009985141318761846,0.016163324714865965,-0.0079712224027641,-0.004161016958333364,-0.001921343823540015,0.02580415049459376,-0.016709033169954608,-0.03757583298250189,-0.008471453445837326,0.015513674142622141,-0.016670053595452893,-0.0023111346791137187,-0.0033749388066560988,-0.009426440913936046,0.01331785209782066,-0.02032109322010376,0.005733173261687896,-0.015422723043881554,0.006509506519739732,0.02341343430257395,-0.001091414232624921,0.005684449259222032,0.0025027817702203206,0.014045461819067915,-0.009647322685918936,-0.002954289509319605,-0.009283517359634027,-0.009783749334029816,0.0076918717346899194,0.012629221951075121,0.017618544157360472,-0.01372063606728472,0.004339671168380248,0.04251318366454837,-0.026518767334781295,0.021464479791874793,-0.005369368401064268,0.005872847897233064,0.007373542889097867,-0.013499755226624395,-0.01942457418243505,0.029831990189234377,-0.0028308557422684426,0.02307561566973104,-0.029026422250306255,0.013993490294829042,0.0019814364805178114,0.01804731388894397,-0.010134560847932444,0.001838513275461752,0.007380039329627725,-0.0014089313141890422,-0.0021081187006645433,-0.005859855016173346,-0.021802298424717703,-0.010907646118549991,-0.012544767758525673,0.004307188500069673,-0.002936423948616532,0.010530847911205366,0.017696503306363905,0.006769366934901774,-0.01325288769252207,0.00604825411984566,-0.020269121695864888,-0.02089278743731184,0.0008778413636917447,-0.0007300457118229712,-0.0179953423647051,-0.02197120867246172,-0.026583732671402446,-0.03913499733611926,-0.01908675554959214,-0.019645455954417936,0.014279336472110521,0.007886767278892091,-0.009907183101080977,-0.020541974992086647,0.0017767963919361712,-0.020567960754206083,-0.015890471418644206,-0.02570020744611602,-0.0040765623001226365,-0.0031540572675038507,-0.003495124120611691,0.017150794851275263,0.017969356602585664,-0.023920163183160877,-0.0024735475550053147,0.00570069059337732,-0.027571202807811744,0.007100689127214826,0.008354516584977304,0.0359906847294102,-0.03323616414242804,0.014617155104953431,-0.003962872961035623,-0.015747548795664746,0.030715515414520805,-0.02089278743731184,0.008627369881199064,-0.01173270291340641,0.017150794851275263,0.013155439687590344,0.008698831192688793,-0.012323885986542785,0.0005379925058717628,-0.027493245521453435,0.01160277317148667,0.016592094446449462,-0.014786064421374886,-0.004287698712818816,-0.018086293463445684,-0.00988769331383012,0.014993953312298056,0.008523425901398759,0.005846862135113628,0.02080183633857125,0.017631537969742754,0.008906720083611963,0.010602310154017656,0.028662617855343908,-0.009218552954335438,0.0049535915505404884,0.04659299488342786,0.019125735124093855,-0.024751716884208436,0.02725936993708827,-0.026180948701938385,0.012655207713194555,-0.024426890201102683,0.018580028531650333,-0.005535029264390153,0.02910437953666456,-0.010940128786860567,-0.002554753992951113,-0.026310879375180687,-0.001970067593175238,-0.009277021384765449,0.014773071540315168,0.03718604096277498,0.007224122894265988,0.012928061940738877,-0.011778178462776704,0.0030371199409825475,-0.007081199805625249,-0.005086770211217079,0.03193686113529527,-0.0015591631894641728,-0.026310879375180687,0.000985033796587619,0.020204156359243736,-0.004891874667014908,-0.002278652010803143,-0.002691180641061993,-0.004992570659380923,-0.012128990908001893,0.0023371206740637946,0.005005563540440641,-0.014461238669591694,0.0054960501555497195,0.006019019904630654,-0.025934081167836062,0.04378649904691658,-0.01909974936197442,-0.01057632346057566,0.02520647237791137,0.028532687182101606,-0.01119998920202261,0.012609732163824263,0.008231082817926142,0.01531877906408125,0.005898834125013781,0.014487225363033691,0.036848224192577196,0.0008510432554677761,0.009705791116348946,-0.022270047730802916,-0.01537075058832012,0.007152661117114978,-0.0015291168609752749,0.007912753041011527,0.0010175164648981944,0.002254290242400852,0.025518305248634843,-0.004836654224019185,0.01517585550977923,0.0033749388066560988,-0.014253350709991085,0.02637584471180184,0.025726193208235455,0.015747548795664746,0.003959624973601333,-0.0168779415550535,-0.027701133481054047,0.003543848123077554,0.0026798117537194196,0.007237115775325705,0.001127957118058998,0.030793472700879114,0.012603236188955685,-0.020632926090827234,0.011921102017078723,0.017241745950015847,0.015383743469379839,0.0007726790393576212,-0.02136053674339705,0.022750790849270407,0.0019749400399879523,0.006301618094477842,-0.016488151397971718,0.003413917915496533,0.0021454735829571927,0.008451963658586468,0.010550337698456223,0.010322959951604756,0.01635822072472942,0.02659672648378473,-0.009393958245625472,-0.01084268078192884,0.016501143347708875,0.010868666544048276,-0.007945235709322103,0.029156352923548554,0.02136053674339705,-0.00043892068184587233,0.0020528982576688212,-0.0024248235525394517,-0.012271913530981352,0.025037562130167352,0.0017459379501733807,-0.001106031456647744,0.014993953312298056,-0.016306249200490546,0.013434789890003244,-0.03780970670422193,0.014019476056948478,-0.011700220245095835,-0.0038491840876098892,0.016410192248968287,0.009900686194889837,-0.01695590070405693,-0.0032352637054496487,0.015513674142622141,0.015994416329767072,0.00240371000440209,-0.0295201573185109,-0.012583746401704827,-0.004687234229187307,0.0964082615225682,0.025752178970354887,-0.009322496934135742,0.020360072794605475,0.005213451965702531,0.010050106655382997,-0.020139191022622585,-0.04217536689435058,0.017904391265964513,0.00700324158794438,0.029234310209906862,0.005333637745319404,-0.008978181395101693,0.03666632199509602,-0.020009262212025408,-0.006606954059010178,0.011050569672852012,-0.012863096604117727,-0.01728072552451756,-0.02051598922996721,-0.01694290689167465,-0.00995265865045127,-0.005411595497338991,0.006204170089546116,-0.016007408279504226,-0.0240371000440209,-0.019801372389779675,-0.0016647315122275824,-0.025492319486515407,-0.0028860761852641647,0.005005563540440641,-0.003543848123077554,-0.014682120441574582,-0.014786064421374886,-0.009978644412570707,0.007665885972570484,0.0006492453305141192,0.030221780346316156,-0.0037842189838193786,-0.018722951154629793,0.018463091670790313,0.005229693299857818,0.02341343430257395,-0.006233404770422403,-0.005132245760587373,-0.0057916416921179065,-0.004849647105078903,0.0068083460437422085,0.025635242109494867,-0.0124862983967731,0.03661435047085715,0.007412521997938301,-0.0007527834865081179,-0.012499292209155381,0.0044306222671208345,-0.026414824286303554,0.0047684408999637455,0.008523425901398759,0.00011612517686762309,0.00611321899080553,-0.008945698726791117,-0.007081199805625249,0.036354489124372544,0.004352664049439966,-0.01207701845244046,-0.014682120441574582,-0.017176780613394695,-0.012622725976206542,-0.012525277971274815,-0.0046060280240721495,0.0012375857743612297,-0.014396273332970543,-0.020788842526188973,-0.005957303021105073,0.01826819566092686,0.02058095456658836,0.02189324952345829,0.004930853775855342,0.01887886758999153,-0.0013634557648187489,0.022932693046751582,-0.03269045382469427,0.01132991894394235,-0.024543827061962703,-0.015994416329767072,0.028038952113896957,0.011830150918338138,-0.004674241348127589,-0.020775850576451815,0.008451963658586468,0.015461701687060708,0.03313221736866005,0.025284429664269675,-0.024322947152624938,0.0008721569200204579,0.012473305515713382,-0.004303940046974103,0.0059897852237543675,0.0044143809329655476,-0.014708106203694017,-0.00789976015995181,-0.01916471469859557,0.014954973737796341,-0.027727119243173483,0.025778164732474323,-0.005002315553006352,0.004515076925331563,0.007009738028474239,-0.010355442619915332,-0.022620860176028105,-0.013863559621586741,-0.04742454672183029,0.007172150904365835,0.008289551248356153,-0.009283517359634027,0.017176780613394695,0.015084904411038644,0.0403563411942486,0.019333623083694462,-0.021308563356513054,-0.004823661342959468,-0.03094938913624085,0.012596739282764545,0.006629691833695324,-0.035652864233922166,0.014110427155689064,0.015097897292098362,-0.017124809089155826,0.0026603221992992023,0.0025368884322480405,-0.00048155406758818237,0.019047777837735546,0.006561478509639884,-0.010472379480775354,-0.024517841299843267,0.016488151397971718,0.005470064393430283,-0.0037679778824947314,-0.013538733869803548,0.019814366202161954,-0.009445930701186905,-0.031027348285244283,0.013434789890003244,-0.007958228590381821,0.0025498815461383988,-0.020567960754206083,0.009244538716454875,-0.0019067267159325124,-0.025297423476651957,0.015734554983282467,-0.005193962644112954,-0.018904853352110965,-0.024738723071826157,0.00398561120138205,0.008737810767190508,-0.0399665491745217,-0.015279799489579535,-0.02443988401348496,0.011745695794466129,0.013551726750863266,0.0336259524368647,-0.013694650305165285,0.009367972483506036,0.007393032210687443,0.006480272304524726,0.0028113661878482257,-0.0027577699714002885,-0.01297353749010917,-0.04079810473821438,0.0032580014801347956,0.000652899607415995,0.03495124306876203,0.012174466457372187,-0.016254275813606552,0.016111353190627092,0.016098359378244814,-0.0045995315835422905,0.004125285836927219,-0.008348019678786164,-0.03999253679928626,-0.012122494001810754,0.0074644939878384525,-0.007659389532040625,-0.004479345803925418,-0.03240460857873536,-0.014734091965813453,0.034613422573273996,0.010245001733923889,0.004567048915231715,-0.014851029757996037,0.01725473976239813,-0.010894653237490273,0.0293902266452686,-0.013850566740527023,0.007399528651217302,-0.031001362523124847,0.010407414144154203,-0.014331308927671954,0.007678878853630201,-0.010745232776997115,0.00961484001760836,-0.016864949605316346,-0.01572156303354531,-0.023829212084420293,0.026518767334781295,0.011141520771592597,0.005531781276955865,0.0019148473830101563,0.027493245521453435,-0.005258927515072824,-0.0004803359558850038,-0.02011320526050315,0.0008924585295069076,-0.0026164708764766943,0.008763796529309944,-0.024556820874344985,0.002808117967583296,0.0020918773665092555,-0.02744127213456944,-0.025999046504457213,-0.011109038103282022,-0.03061157050339794,0.04238325299130607,0.02570020744611602,0.0006618323295598711,-0.01008258839237101,-0.011693724270227256,-0.02628489361306125,0.015487688380502705,-0.0013139198819096336,-0.01359070632536498,0.02644081004842299,-0.012889082366237162,-0.00666542295510147,-0.020282115508247166,-0.030923403374121416,-0.018917847164493243,-0.0025141506575628936,-0.03450947952479626,0.010407414144154203,0.005184217750487525,-0.00975776357191038,0.01598142251738479,-0.00011348596879853784,0.0037582329888693027,0.0021097426943816875,-0.01003061686813214,-0.0019180956032750856,-0.019866337726400826,-0.04342269465195423,-0.03515912916571751,-0.03185890198629184,-0.022296033492922352,0.024621786210966133,0.008361012559845882,-0.018696965392510357,0.029624100366988645,-0.012038039809261308,-0.0107127510400091,-0.020438031943608905,-0.012369361535913078,0.03796562500222879,-0.002725287303089713,0.003975866307756621,-0.007678878853630201,-0.007204633572676411,0.00528816173028783,-0.00954987468098721,-0.013837573859467305,0.027025496215368226,-0.0016428058508163282,0.009777252427838676,-0.01194059180432958,-0.004394891145714689,-0.02594707498021834,0.002367979115826585,-0.0008246511456730936,-0.016631074020951177,-0.018800910303633223,-0.0031069574915857726,0.025362388813273108,0.0029656583966621783,-0.03315820499342461,-0.008406488109216174,-0.016709033169954608,0.008088159263624122,-0.023439420064693385,0.002603477762586336,0.006775863375431633,-0.004336422715284678,0.0005132245644172053,-0.009283517359634027,-0.012180962432240766,0.01804731388894397,-0.003420414356026392,0.005830620800958341,-0.00043607846001022897,0.018722951154629793,-0.014539196887272562,0.011076555434971446,0.014201378254429652,-0.006158694540175823,-0.01681297621843235,0.008542914757327056,0.02402410623163862,-0.02197120867246172,0.011433863855065216,0.010751729683188254,-0.01742364814749702,0.012161473576312469,0.013499755226624395,-0.010186533303493877,-0.008367509466037022,-0.02944219816950747,0.01201855002201045,-0.008737810767190508,0.01132991894394235,0.004498835591176275,-0.010868666544048276,0.0019716918197230228,0.02443988401348496,0.0013480265439373537,0.013473768533182396,-0.004323429834224961,0.011615766052546389,0.010491869268026211,0.02697352282848423,0.01860601429376977,-0.019255665797336157,-0.001778420502068636,0.0030793472700879113,0.006892800701952936,0.0014925739755411976,-0.01791738321570167,-0.02699951045324879,0.0021178633614593314,0.010329455926473335,0.010517855030145648,-0.018800910303633223,-0.003524358568657337,-0.006431548302058864,0.022425964166164655,0.012336878867602503,-0.0006792916590030172,-0.012245927768861917,-0.0030371199409825475,-0.014954973737796341,-0.005788393239022337,-0.028792546665941086,-0.01524082084640038,-0.003452896791506327,0.036484419797614846,-0.010270987496043323,-0.0006598021627904602,0.011161009627520894,0.0002312352703505407,-0.018982812501114395,-0.017137802901538105,-0.009173077404965145,0.016566108684330026,0.030325725257439023,0.022101139345704023,0.022425964166164655,0.027077467739607095,0.006717394945001622,0.005866351456703205,-0.013993490294829042,0.006152198099645964,0.0008583518092715274,0.0055577670390753,0.03396377293235273,0.027779090767412352,-0.033418066339909215,-0.0008542915339403656,0.008672845430569356,-0.002395589337324446,-0.02388118360865916,0.028298811597736437,-0.00700324158794438,-0.024608792398583854,-0.013006020158419746,-0.007854284610581515,0.021386522505516484,-0.0005067280656796862,0.011161009627520894,0.002666818872659702,0.0001863687331760916,-0.015435715924941272,0.021204620308035313,-0.02113965497141416,-0.009303007146884885,0.002351737781671297,-0.002535264438530896,0.038901123614399215,0.010063099536442716,-0.010472379480775354,0.0021519700234870513,-0.02091877319943127,0.04552756559801513,0.0007893263719421951,0.01235636865485336,-0.002114615141194402,0.01098560433623086,-0.017644529919479908,0.007906257066142949,0.019645455954417936,-0.003962872961035623,-0.009972148437702128,0.008276558367296434,-0.011758689606848408,0.003556841004137272,0.00891971296467168,-0.005999530117379796,-0.013785601403905872,0.008211593030675285,-0.01408444139356963,0.024063085806140336,-0.030507627454920198,0.03466539409751287,0.015526667023681858,0.026791620631003057,0.010933631880669427,-0.007055213577844532,-0.014357294689791389,0.03315820499342461,-0.025531297198372,-0.016670053595452893,0.009465420488437763,0.00686031803364236,-0.0012757527699277715,-0.01421437113548937,-0.029026422250306255,-0.0072955846714169974,-0.008822264959739954,0.007743844190251353,0.019593484430179067,0.21765918730279518,-0.020360072794605475,0.002637584424614056,0.02493361908168961,-0.015383743469379839,0.03396377293235273,0.0260899976031978,0.0029624101763972488,-0.014487225363033691,-0.014175392492310215,-0.0358607540561679,0.017228754000278693,-0.01077771544530769,0.007880270372700952,-0.021776312662598267,-0.020412044318844344,-0.018216224136687987,-0.018359146759667447,0.004131782743118359,-0.023920163183160877,0.014656134679455146,-0.014928987975676905,-0.012369361535913078,-0.007230619334795847,0.021854271811601697,0.012583746401704827,-0.02024313593374545,-0.020840815913072967,0.015253813727460099,0.008646859668449922,-0.00308909216371334,-0.016670053595452893,-0.012590243307895967,0.0016988382906706226,-0.003063106168763264,0.004180506279922941,0.016410192248968287,0.0020626429184636094,-0.008185607268555849,-0.0024102064449319487,0.022698817462386413,0.02065891185294667,-0.012291403318232209,0.011492332285495226,0.020827822100690688,-0.00012292621080689427,-0.02527143771453252,-0.0016419937375424358,-0.014357294689791389,0.01861900810615205,-0.021542438940878223,-0.021529445128495944,0.03557490881020898,0.02453083511222555,0.0025921088752437625,-0.0012708804395303774,0.008659852549509638,0.003176795042188997,0.005570760385796299,-0.011856136680457572,-0.02816888278713926,0.019931303063021977,-0.007847788635712939,0.009692798235289228,-0.009647322685918936,0.027129439263845968,-0.04734659129811711,0.0056519665909114565,-0.0019408333779602322,-0.01463014798601315,-0.0063146109755375605,-1.6850331799216923e-05,-0.015552652785801294,-0.02336146277833508,-0.0024410648866947395,-0.014578176461774277,0.0038816667559204644,-0.007107185567744685,0.028038952113896957,0.023530371163433973,-0.009686301329098089,-0.014786064421374886,0.025414360337511977,-0.005132245760587373,0.001333409436329851,-0.006230156317326832,-0.00014464893121116548,-0.01811227922556512,-0.0015542908590667787,0.01716378866365754,-0.0017540586172510246,0.006996745147414521,0.019814366202161954,-0.01783942592934336,0.017293719336899844,0.0044728493633955585,0.017332697048756434,0.030195794584196724,-0.01455218976833228,-0.001429232981883152,0.003035495947265403,-0.013129453925470908,-0.00343015901682118,0.005915075459169069,-0.016709033169954608,-0.01160926914635525,0.014045461819067915,0.008750803648250226,0.010102078179621868,-0.019736407053158524,0.023426428114956228,-0.005041294196185505,0.007438507760057737,-0.011135023865401458,0.005077025317591651,0.012291403318232209,-0.03492525544399747,0.014773071540315168,-0.011251961657584042,-0.021204620308035313,-0.010738736802128536,-0.005609739494636733,-0.006428299848963293,-0.003556841004137272,-0.014721099084753735,-0.02519347856552909,-0.0207368710019501,0.04087606388721781,0.006415306967903576,-0.016501143347708875,0.016968892653794088,-0.03778372280474762,-0.0037777225432895196,-0.014851029757996037,0.017735481018220495,0.014941980856736623,-0.0034269107965562507,-0.01848907743290975,0.0052329417529533885,-0.0010564954573233085,0.009088622281093136,0.00679535316268249,0.006957766038574087,0.007269598443636281,-0.01229790022442335,-0.011485835379304086,0.012025045996879027,-0.03201481655900845,-0.008594887212888489,-0.004706724016438165,-0.01187562646770843,-0.021659375801738247,-0.01181715803727842,-0.026245914038559536,0.005739669702217755,-0.007185143785425553,-0.021503459366376508,-0.02113965497141416,0.022283041543185195,0.02123060607015475,-0.026193942514320667,0.013759615641786436,0.007191640225955412,-0.024011114281901464,0.0031167023852112013,0.004849647105078903,-0.16350425554887124,0.007224122894265988,0.04461805461060926,-0.03728998773654297,0.03396377293235273,-0.02835078498462043,0.02336146277833508,0.03006586391095442,-0.007146164676585119,-0.0056519665909114565,0.03263848230045541,0.023868189796276883,-0.0469567992783902,-0.016033395904268787,-0.012596739282764545,0.004502083578610564,0.0003516238017995013,0.028272825835617,0.005944309674384074,0.016345226912347136,0.014954973737796341,-0.021737333088096552,0.004433870254555124,-0.002231552467715705,0.0404862718674909,0.007406025091747161,0.013876552502646458,0.009939665769391553,0.009725280903599804,-0.0146951133226343,-0.019047777837735546,-0.008861244534241669,0.00721113001320627,-0.017878405503845077,0.006392569193218429,-0.009406951126685189,0.004287698712818816,-0.00048236612265441475,0.0006037697229361658,0.015552652785801294,0.02024313593374545,0.005167976416332237,0.036640334370331464,-0.0008502312004015437,0.007977718377632679,0.037523861458263016,0.021113669209294725,-0.002644080865143915,0.02614196912743667,-0.011576786478044674,0.02486865374506846,-0.009010664063412268,-0.006350341631282425,-0.008412985015407316,0.012791635292627997,0.013213908118020356,0.003335959697815664,0.013603699206424699,-0.017969356602585664,0.0006017395561667549,-0.01916471469859557,0.006938276251323229,0.020412044318844344,-0.001205915335739867,-0.00205939469819868,-0.019957288825141414,-0.0060125229984395135,0.007178647344895694,-0.017943370840466228,0.007198136666485271,0.00010125425475819885,0.013577713444305263,0.006282128307226985,0.01318142544970978,0.012856599697926586,0.011472842498244368,-0.00700324158794438,0.006603706071575888,-0.0049958186468152125,0.02106169582241073,-0.016306249200490546,0.033755883110107,-0.012746159743257704,-0.023036636095229324,0.017319705099019277,-0.007704865081410918,-0.014032468938008196,-0.023309489391451083,-0.0292602959720263,0.013746622760726718,-0.0009200686927971084,-0.019788380440042518,-0.021815292237099982,0.0061814323148609695,0.014708106203694017,0.02363431607455684,0.028324799222500995,-0.019190700460715006,0.024816680358184465,-0.008887230296361105,-0.010946624761729145,-0.00967330844803837,-0.006925283370263512,0.012863096604117727,0.027129439263845968,0.012947550796667174,0.028194868549258695,0.015630611934804726,0.019801372389779675,-0.01221994200674248,-0.0025563779866682574,0.0005968671675617006,0.018099287275827967,0.01242782996634309,-0.0002023054811979246,0.0037842189838193786,-0.01352574098874383,-0.003631551001553211,-0.006096977656650242,-0.00042349146096447705,0.053219436867043765,0.005915075459169069,-0.029909947475592683,0.012414837085283372,-0.025986054554720056,-0.003152433040956066,-0.1113242566171854,-0.007867277491641234,-0.028272825835617,0.011303933181822913,-0.005278417302323681,0.004726213338027741,-0.00597029590216479,0.013759615641786436,0.011966577566449017,0.020528983042349493,-0.015578639479243291,-0.0372380162123041,0.0029900203978951096,0.007230619334795847,0.003699764325608651,-0.03422363427883734,-0.010524351936336787,-0.02576517278273717,-0.011862633586648713,-0.008055676595313546,-0.00891971296467168,-0.0016298128533412902,0.007542452205519322,-0.02212712510782346,-0.044825940707564745,-0.02637584471180184,-0.018904853352110965,0.0020528982576688212,0.0046287657987572955,0.0062723838792628364,-0.010615303035077375,-0.012174466457372187,0.017397662385377585,-0.004830157783489326,0.015617618122422445,1.3234108155139908e-05,-0.01290857215348802,-0.030663543890281936,0.028220854311378128,-0.02362132226217456,-0.0034171661357614625,-0.0009639201902425971,-0.008620872975007923,0.006944772691853088,0.0005785957248446619,-0.006632940286790894,-0.02835078498462043,0.016838961980551785,-0.016631074020951177,0.00700324158794438,-0.016241283863869395,-0.010517855030145648,-0.029286281734145735,-0.018735944967012072,0.02576517278273717,-0.0075749348738298975,0.015409730162821836,-0.003279115261102798,-0.0076918717346899194,0.02091877319943127,0.012863096604117727,-0.003303477029505089,0.0037939638774448074,-0.00209674981332197,-0.008900223177420823,-0.007159157557644837,0.0028064937410355113,-0.030377696781677895,0.006148950112211675,-0.032820384497936575,0.0038881631964503235,0.027545217045692308,-0.013298363241892364,0.006421803408433435,-0.019580490617796785,0.013629684968544135,-0.02415403690488092,-0.02443988401348496,0.017046851802797518,-0.022893713472249867,-0.010998597217290578,-0.01882689606575266,0.02671366334464475,-0.03279440059846227,0.014123420036748782,0.0016582350716977236,0.001144198452214286,0.00026026655911047834,0.029052408012425687,-0.028038952113896957,0.02312758719396991,0.015383743469379839,0.013278873454641507,8.653558933571442e-05,-0.02419301647938264,0.043084877881756446,-0.005486305727585571,0.008744306742059086,0.009842217764459826,0.014253350709991085,0.0068083460437422085,0.0001533786250365686,-0.0602876461199157,0.046437076585421,-0.007613913517009051,0.011823654012146996,-0.011206485176891186,-0.016864949605316346,0.03404173208135616,-0.02697352282848423,-0.007815305967402363,0.043006918732753016,-0.017696503306363905,0.024829674170566744,0.008906720083611963,-0.0049958186468152125,-0.04929554394617114,-0.029831990189234377,0.001984684933613381,0.007269598443636281,-0.005122500866961944,0.02123060607015475,-0.010426903931405062,-0.001452782869842191,-0.002561250433480972,0.023790232509918574,0.004359160489969825,-0.0017118312881456606,0.009725280903599804,0.016332234962609982,-0.006801849603212349,-0.008374005440905599,0.01333084591020294,-0.021334550981277615,0.006931779810793371,0.000419025128996369,-0.0049535915505404884,-0.01070625413381796,0.012025045996879027,0.0017702999514063122,0.01173919981959755,0.05638973709851739,-0.0025466333258734692,-0.020139191022622585,0.011141520771592597,-0.03651040369708916,-0.005996281664284227,0.022140117057560613,-0.010394421263094486,0.012869593510308867,0.03308024584442118,-0.010238504827732748,0.013486761414242114,0.028792546665941086,0.004479345803925418,-0.009991637293630425,-0.014461238669591694,-0.003295356362427445,0.03011783543519329,-0.014370287570851107,0.001955450485567735,-0.04898371107544767,0.018125273037947403,-0.0069772553601636636,-0.018242209898807423,-0.0005822500017465377,0.01612434700300937,-0.016033395904268787,0.02576517278273717,0.007737347284060212,-0.013226900999080074,-0.02163339003961881,-0.016838961980551785,0.009108112068343993,0.018411118283906316,0.021997194434581157,-0.00018281594132962242,0.0059183239122646385,-0.019138728936476133,-0.005794890145213476,-0.026336865137300124,-0.006460782517273869,0.006366582965437712,-0.009309504053076024,-0.043682555998438836,0.015591632360303009,0.01833316099754801,-0.001040254239583341,0.015006946193357774,0.004209740495137946,0.004716468910063594,0.006847325152582642,-0.011180499414771752,0.011225974964142045,-0.0031167023852112013,0.006743380707121057,0.02065891185294667,0.04162965657661681,-0.020347080844868318,0.016098359378244814,0.008497439207956762,0.00010196481021710969,-0.0024881646626128177,0.0010280732389668752,0.00810115214468384,-0.006671919395631328,-0.006775863375431633,0.004079810287556926,-0.0012611356623202688,-0.05189414996043668,-0.013421797008943526,0.008062173501504686,0.01277214550537714,-0.009023656944471985,0.018567034719268054,0.0015055669730162358,-0.02699951045324879,0.03840738854619457,0.01638420648684885,-0.02107468963479301,0.009432937820127187,0.015838499894405333,0.009868203526579262,0.017800446354841647,-0.008016697952134394,-0.0015900216312269633,0.03508117374200433,-0.0026651946461119166,0.027129439263845968,-0.016436178011087724,0.010309967070545038,-0.011031079885601154,0.005928068340228786,0.00796472549657296,-0.012051032690321026,-0.009062636518973701,0.002484916442347888,-0.030247766108435593,-0.002223431800638061,0.017046851802797518,-0.02580415049459376,0.05316746534280489,0.003439903910446609,-0.009504399131616915,0.023946148945280313,-0.017631537969742754,0.02519347856552909,-0.013785601403905872,-0.003246632592792222,-0.003102085044773058,-0.014123420036748782,0.019359610708459023,-0.001512875526819987,0.020957752773932987,-0.010595813247826517,-0.026817608255767615,0.024011114281901464,0.0031183263789283456,-0.013733628948344439,-0.006119715431335388,-0.018151258800066836,0.0240371000440209,-0.0168779415550535,0.014513211125153127,-0.013967503601387045,-0.020762856764069536,-0.010511359055277069,0.05524634866410123,-0.010420407956536483,0.005716931927532608,-0.028792546665941086,-0.0029088139599493116,-0.005103011079711086,-0.017124809089155826,-0.01331785209782066,0.03157305674033292,-0.02280276237350928,0.009316000027944603,-0.01709882332703639,-0.006775863375431633,-0.0015680959698157091,-0.013941517839267609,0.02564823405923202,-0.020490003467847778,-0.0130449988015989,0.0023013897854882895,0.028194868549258695,0.003050113054872906,-0.003852432540705459,-0.0066166989526356065
        ]

        document_content2 = [
            -0.006706479352625513,-0.035767888638905905,-0.02155513614221195,-0.02881884910313523,-0.027376595438857804,0.04371339681496104,-0.019968655993919632,-0.023587401314497235,-0.018211728904489598,-0.01998176715380367,0.024898541517289055,0.0021273241082430745,0.029579309414926053,-0.012855724165630635,0.011806812748455277,0.00424481438091181,0.02989398284007866,0.0077619468154041995,0.011931370629998867,-0.025160770302905516,-0.023128503267974984,0.0023829963825948955,-0.010403892563829958,-0.0025386942001856946,-0.0010284251134412227,-0.012278822886184187,0.016140128389906954,-0.024256083507099804,0.020860231629841307,-0.010167887960626815,0.00095385411103216,-0.0037695264532118904,-0.01357029541782733,-0.007047375563207504,-0.04179913021898683,0.004248092636544131,-0.0048741616968783355,-0.010194110280394887,-0.0067130349325675315,-0.04313649460419197,0.013714520970519596,0.003959641531159596,-0.010154776800742778,-0.0020814341173263245,-0.023521845515077053,-0.002219103857245918,-0.003903918170329819,-0.008024174204036727,-0.03149357228560977,0.0028238670499379087,0.0158647903070517,0.023508734355193017,-0.026275237519501057,-0.013635852148570134,-0.01981132021266595,-0.0009718822469110295,0.007814391920601656,0.010613675778587652,0.016415468335407454,-0.012724609772822403,-0.014855212369528454,0.004448041084404863,-0.006752368877880951,0.0007395646917639593,-0.007676722413512718,0.019640871408882987,-0.001403738817210776,-0.02619657056019684,-0.00845685086211353,-0.018880411097092164,0.026275237519501057,0.037105253024111044,0.010869347121616852,0.023154725587743057,0.008174955336671013,-0.03026110276741266,-0.03047088505084773,-0.006204968173834898,-0.0024616647388830473,0.002925480401684435,0.031519798330668335,-0.0202702182591882,-0.008987862150643226,0.021292907356595486,0.00702115277777812,0.010436671394862672,0.007289936212013978,0.02552788836759427,-0.02274827218075695,-0.012881946485398707,-0.014094751126415008,0.025383663746224625,0.003910473750271837,0.006172189808463496,-0.004877439486849345,0.00585096080336887,-0.01700548170606056,0.03957019578579576,-0.013321178723417527,-0.017162817487314238,0.018709962293309203,-0.009040307721501994,-0.0016946480322429117,0.0008165941530666066,-0.021646916124045446,-0.013491626595877866,-0.007689834039058066,-0.029867760520310586,0.034692754901962476,-0.015445224808858937,-0.004539821066238363,0.010371114664119867,0.004867606116936317,-0.006352471516498174,-0.02842550685603316,-0.031913136852479915,0.003325377995897868,-0.03818038676105447,-0.013832523272121169,-0.013013060878206938,0.008253624158620475,0.02318094790751113,0.006241024794838621,-0.01136102493049444,0.025973675254232484,-0.005834571387852514,0.0033663510690274483,-0.01235093519686901,0.03492875950516562,-0.008253624158620475,0.005215057907460327,0.0388884005706639,0.015117440223822293,-0.01551078153960174,-0.0024813317115397575,0.026760359748436626,-0.02440030812846945,-0.01260660747122083,-0.011760922757538527,-0.030208656265231268,0.021542024982327913,0.002936952666582967,-0.011518361643070742,-0.021660027283929482,0.01947042446774527,0.019247529161780918,0.00632624873106879,0.0028271448399089178,0.007211267855725826,-0.016284354873921845,0.029107300208519767,-0.016166352572320273,0.02231559645400277,-0.0050937773502264345,0.019798209052781915,-0.008909194260016386,-0.006863816065201817,0.022027145348618236,-0.037734599874416255,-0.014448758962542347,0.01676947524021217,0.021581358461980022,0.010941460363624296,-0.023902074739649844,0.00028414854038627383,0.010141664709536119,0.018119948922656098,0.003172957968278078,-0.012114930593665866,0.0020388221492112397,0.011177464966827439,-0.001632368858640461,-0.010082663558735333,0.021096236233044453,-0.021935365366784736,0.014894545849180563,0.008037286295243386,0.0016979258222139207,-0.002646863131874239,-0.015182996954565098,-0.018513291169758167,-0.009368092306538638,0.027035699693937123,0.01490765794038722,-0.02968420055664359,0.0077291679843714866,0.010685788089272475,0.006870371645143835,0.007093265554124254,-0.01166258719576301,-0.007401383399334843,0.005297004053719487,-0.0022666327431481725,0.006863816065201817,-0.6545209031313665,-0.021987811868966128,-0.008791191027092192,-0.024688759233853982,-0.008181510916613031,0.0021584635786289718,0.004772548345131809,0.024767428055803446,0.001947042400208396,0.005982074730515791,-0.02114868273522584,0.003471242210744984,0.007303047837559325,-0.022787607523054306,-0.014055416715440276,0.006791703288855683,-0.007434161764706245,-0.008476517601939584,0.023089169788322875,-0.02133224269889284,-0.015550115950576471,0.02592123061469634,0.00602140867582921,-0.042192472466088905,0.008660077565606583,-0.00353024336154577,0.024557645772368374,-0.02470187039373802,-0.011170909386885421,0.020650449346406235,-0.0022240205422024316,-0.0036482461288086534,0.0007309603184670688,0.03621367552554412,0.0392555204979979,-0.013294955472326831,-0.028373062216497016,0.009368092306538638,-0.000314673512464103,0.03395851504729448,-0.0009792574489687917,-0.0016176185709402644,0.0304971073706158,-0.021778029585531055,0.019522869107281415,0.010521895796754154,0.03285715899058298,-0.00853551875274037,0.006178745388405514,0.015025660241988793,0.007112932293950308,-0.011642919524614333,-0.021227351557175304,-0.011092241496258582,0.008987862150643226,-0.0040579770929351135,0.022944943304307984,-0.00958443110123835,0.026589910944653662,0.004959385633108506,-0.00932875882688653,0.050478874524419466,-0.004677490573327301,0.009453316708430118,-0.0043365943627453095,0.022420487595720306,-0.02137157617854495,0.00940742671751337,0.036423457808979195,-0.0218304742250672,0.03605634160693569,0.018224840064373634,-0.013078617608949742,-0.01443564780265831,0.008640409894457905,0.008043841875185405,0.03246381674348091,-0.020099771318050484,-0.00042693985623940093,-0.0037301922750678142,0.016795699422625487,-0.020230884779536093,-0.03167713224927677,-0.006336082100981817,0.018185506584721525,-0.008253624158620475,-0.0058640719632529065,-7.098591962827144e-05,-0.0034974649961743683,-0.006850704439656469,-0.021843585384951236,0.02185669840748052,-0.011951037369824922,0.005795236976877782,0.017346377450981238,-0.017661050876133844,0.008260179738562494,0.015392779238000169,0.014370090140592883,-0.02695703087198766,0.009256645584879084,-0.02782238232549602,0.0033335724708253908,-0.016808810582509524,0.01853951348952624,0.011203688217918135,-0.02127979619671145,-0.001380793938167729,0.05328471489367011,-0.018841075754794812,0.01443564780265831,-0.0046611016234722556,-0.0013939053308824208,0.0016864533244847332,0.0053035596336615054,-0.02748148658057534,0.015196108114449134,0.0014815878424215034,0.030208656265231268,-0.04355605917106211,0.009820435704441494,-0.005401895195437024,0.010718566920305189,-0.010305557933377063,0.021633803101516167,-0.005683790255218229,0.004169423814594667,-0.0040120871020183635,-0.0037367478550098324,-0.020480000542623274,0.005660845259759854,-0.0020502946469404273,0.0014029193697180236,-0.006005019725974165,0.007073598348636888,0.015327222507257364,0.004208758225569399,-0.006739257717996915,0.034797644181034766,-0.030995340759435407,-0.016756364080328132,0.01096112710345035,-0.010600563687380993,-0.015812343804870312,0.002548527570098722,-0.040094649631738186,-0.01856573767193956,-0.015550115950576471,-0.01944420028533195,-0.0021109346927267176,0.017661050876133844,-0.017359488610865274,-0.014527426853169188,0.0033106274753670157,-0.009479539959520814,-0.01673014176056006,-0.01035144699297119,-0.007984840724384618,0.005382227989949658,0.0006248400055104046,0.00528717068380646,-0.002751754273591775,-0.023312063231641984,0.002453470031124869,0.021843585384951236,-0.030365993909130196,-0.006876927225085853,0.021266685036827413,0.031047787261616798,-0.02592123061469634,0.012036261771716402,-0.011754367177596509,0.0019962101810961546,0.02803216460893109,-0.01594345726635592,0.007899616322493138,-0.010849680381790797,0.0219222542069007,0.0010079385768764324,0.01305239528918167,-0.005001997834054246,-0.011072573825109904,-0.017910166639221025,-0.0010521895563923498,0.018749297635606555,-0.004647989997926908,0.012632830722311526,-0.006077132036658987,-0.010240000271311637,0.012783611854945812,-0.00853551875274037,0.014016082304465546,0.014514315693285151,0.004749603349673434,0.01477654354757899,0.007512830120994397,0.019195084522244773,-0.0017602049958163714,0.009309091155737852,0.0554874307323836,0.015576339201667167,-0.025160770302905516,0.03726258694271948,-0.021738694243233703,0.02824194689236616,-0.02803216460893109,0.012429604018818473,-0.01564189500108735,0.034981204144701766,-0.011636363944672315,0.0024026633552516057,-0.020807785127659916,-0.029185969030469227,-0.013255621992674722,0.009984327996959816,0.05257670108406067,0.0104104490750946,0.016651472938610596,-0.02748148658057534,-0.002099462427828186,-0.014055416715440276,-0.015353444827025437,0.035033652509528404,-0.009728655722607994,-0.022931832144423948,-0.010889014792765528,0.01750371323223492,0.003989142106559989,0.013465404276109793,-0.0007096543344095263,-0.008338847629189334,0.004654545577868926,-0.004349705522629346,0.013124507599866492,-0.021542024982327913,0.01547144805994963,0.011813368328397295,-0.029474418273208517,0.04924640314357712,-0.011557696054045474,-0.018841075754794812,0.022381154116068197,0.02881884910313523,-0.006627810996337361,0.00853551875274037,-0.007394827353731513,0.017411935113046666,0.008856747757834994,0.006975262786861371,0.030313547406948804,0.004008809312047354,0.005883739168740272,-0.013544072166736634,-0.017267708629031774,0.011164353806943403,-0.005536286912554952,0.01248860516961926,0.0021076569027557086,0.01174125508638985,0.017975724301286453,-0.008745301036175442,0.0020568502268824454,0.00542156240092439,0.001016952732127363,0.026930808552219587,0.013399846614044367,0.01780527549750349,0.0171497063274302,-0.0164679129749436,-0.01036455908417785,-0.00018540334217587599,-0.011236467048950849,0.009171422114310225,0.017018592865944596,0.029238413670005372,0.022250038791937345,-0.022905609824655875,0.005405172985408033,0.019614649089114915,0.0017323431989861551,0.0032794880049811185,-0.030759336156232265,0.015484559219833667,0.020952011611674808,0.003281126899966623,-0.03949152510120105,-0.008378182040164066,0.020453778222855202,0.005962407525028425,0.01421275342801658,0.013701408879312938,0.022944943304307984,0.036423457808979195,-0.0027468375886352614,-0.008784635447150173,0.009151754443161547,0.009191088854136279,-0.01840840002804063,0.02782238232549602,0.008646965474399923,-0.012731166284087044,-0.0023567735971655114,-0.022459821075372415,-0.005231447322976684,0.030575776192565265,0.002128963003228579,0.006857260485259798,-0.002673085917303623,-0.015419002489090864,0.010154776800742778,-0.03574166631913783,0.007807836340659638,-0.013596517737595402,-0.007899616322493138,-0.007571831271795183,0.006552420430020219,-0.013622740988686098,-0.012029706191774384,0.029657978236875517,0.007335826202930727,0.024714981553622055,-0.0292121913502373,-0.010784123651047993,-0.007552164066307817,0.1001710645546348,0.032254034460045836,-0.013832523272121169,0.006437695452728345,0.01776594201785138,0.020125993637818557,-0.020073547135637165,-0.03007754280374566,-0.002374801674836717,-0.0042907043718285595,0.01971954023083245,0.001649577605234242,0.006526197644590835,0.025514777207710233,-0.007486607335565013,0.010548118116522226,0.004048143723022086,-0.02497721033923852,-0.015379668078116132,-0.03188691453271184,-0.010403892563829958,-0.01804128196335188,4.40460958148553e-05,0.010430115814920654,-0.025226326102325697,-0.02281382984282238,-0.01430453340985008,-0.005362561250123603,-0.007112932293950308,0.010095774718619369,0.0030451218311021676,-0.005644456309904808,-0.0015889373266172958,-0.017175928647198274,-0.0061295776075177555,-0.0007764405274297784,0.012973726467232206,0.018775519955374628,0.0031237901873903194,-0.012200154064234725,0.011079130336374546,-0.0008981306337870552,0.019352420303498454,-0.01582545496475435,-0.011118463816026655,-0.004916773432162765,-0.0024075800402081193,0.003513854178860069,0.019181973362360737,-0.008397849711312744,0.03825905372035869,0.011275800528602957,-0.005005275624025255,0.0010423559536486668,0.0036974136768657567,-0.017057926345596705,0.01201003945194833,0.0028271448399089178,-0.0004265301033891928,0.027035699693937123,-0.01084312480184878,-0.020322664761369593,0.03574166631913783,-0.0019912932633089856,-0.015287888096282632,-0.020584891684340807,-0.0010874263806573364,-0.007657055673686664,-0.029290860172186763,0.001161997499481727,-0.002092906615055512,0.002358412492151016,-0.014658541245977418,-0.006250858164751648,0.017477490912466847,-0.0012537772484845706,0.0205455582046887,-0.013412958705251027,0.001304583924357834,0.004441485504462845,0.015274776936398596,-0.025239437262209733,0.004605377796981167,-0.0154321136489749,-0.019352420303498454,0.017175928647198274,-0.0037236364622951408,0.01503877140187283,-0.030025098164209514,-0.0018339565507326818,0.0029238412738682752,0.023587401314497235,0.01673014176056006,-0.01627124371403781,-0.00022166454856638294,0.0267865820682047,0.0032565430095227435,0.01853951348952624,0.006139411443092093,0.0010751345518507246,0.007643944048141316,-0.03886217825089583,0.009564763430089673,-0.03041843854866634,0.022853163322474487,0.005080666190342398,0.012409936347669796,0.01707103750548074,-0.0004728297307408228,-0.021384687338428986,-0.013675186559544866,-0.0401733165910424,-0.003286043817753792,-0.007866837491460424,0.02110934739292849,0.006699923307022184,0.027035699693937123,0.03663324009241426,0.012711498612938367,-0.013635852148570134,-0.010371114664119867,-0.03532210175226769,0.020217773619652057,0.010639898098355725,-0.023338285551410057,0.009263201164821102,0.023154725587743057,-0.01990310019449945,-0.014029194395672203,-0.012691831873112312,-0.017844610839800844,0.029317082491954836,0.0032794880049811185,0.002063406039655119,-0.022171371832633128,0.012862279745572653,0.003923585375817185,0.0024256083507099803,-0.012927836476315456,0.03107400958138487,-0.02162069194163213,-0.0022076313595167305,0.009885992435184298,-0.007853726331576388,-0.005300281843690496,-0.029081077888751694,0.01494699142003933,-0.02729792661690834,-0.004487375495379595,0.012128041753549902,-0.026183457537667557,-0.016100794910254845,-0.027402817758625877,0.004457874919979202,-0.0002587452024496421,-0.03461408794265826,-0.02133224269889284,-0.024229861187331732,0.008004507464210673,0.0133474010431856,0.0416417963003784,-0.015904123786703812,0.006831037699830415,-0.00888297100892569,0.010594008107438975,0.007676722413512718,-0.0034253522198282346,-0.019732651390716487,-0.0414582363367114,0.011937926209940886,0.012777055343681171,0.039465302781432975,0.011859258319314045,-0.021896031887132628,0.029579309414926053,0.013635852148570134,0.0006637644599081044,0.0040546993029641045,-0.013622740988686098,-0.03744614690638648,-0.008830525438066922,-0.002959897662041342,-0.009630320160832477,0.0022371319349171236,-0.014488093373517079,-0.01669080828090795,0.04594233124815211,0.008129065345754263,-0.005601844108959067,-0.02887129560531662,0.015930346106471885,-0.01962776024899895,0.0137800777012624,-0.007381716193847477,0.010121997969710065,-0.023508734355193017,0.01763482855636577,-0.009781101293466762,-0.009250090004937065,0.0008350320708995162,-0.008548630843947028,-0.00464143441798489,0.0028156723421797303,-0.02298427864660534,0.01391119116274801,0.014960103511245989,0.0030926507170044217,-0.01547144805994963,0.03844261368402569,-0.016231908371740454,-0.006765480503426299,-0.020558669364572735,-0.006339359890952826,-0.0043824843536620596,0.0008604354088361478,-0.006595032165304647,0.003202458543678471,-0.002612445638686677,-0.017333266291097202,-0.022341818773770842,-0.024164303525266304,-0.021122458552812525,0.05097710977588432,0.022866274482358524,0.0072440466867585394,-0.020768451648007807,-0.02661613512706698,-0.025029654978774664,0.023770961278164235,0.00797172863317796,-0.01981132021266595,0.021961589549198055,-0.010436671394862672,-0.015235442525423864,0.0004920870669626526,-0.042323587790219754,0.004411984929062452,-0.004739769979760407,-0.04048799187884026,0.03500742646446984,0.002443636428381186,-0.004156312654710631,0.006732702138054897,-0.001473393134663325,-0.01627124371403781,0.009735212233872635,-0.008699411045258692,0.004585711057155112,-0.007414494559218879,-0.044159183701599256,-0.029107300208519767,-0.01688747754181374,-0.0025600000678279093,0.03141490532630555,0.006044353671287585,-0.020781562807891844,0.0312837900021747,-0.006250858164751648,-0.017661050876133844,0.0014299617190554877,-0.019640871408882987,0.029579309414926053,-0.0033958516444278415,-0.0016053266257183248,-0.010141664709536119,0.017175928647198274,-0.0047889372949868544,-0.0014881435387788494,-0.01404230555555624,0.027061922013705195,0.008063508615011459,0.00602140867582921,-0.003995698152163318,-0.011911703890172813,-0.007820947500543674,0.0007194878789455452,-0.0023600513871365205,-0.010200666791659528,-0.02592123061469634,-0.012763944183797135,0.021673138443813522,-0.00264358534190323,-0.03372251044409134,4.489116923165105e-05,-0.024596979252020486,-0.008122509765812245,-0.006136133653121084,-0.00763083288825728,0.0007698848310724324,-0.014592984515234613,-0.0030008707351709225,-0.017346377450981238,-0.0021469910808997843,0.025200103782557624,0.0029533420820993237,-0.002632112844174043,0.009164865603045583,0.012095262922517188,-0.013058950869123688,0.0050478873593096845,0.015419002489090864,-0.003805582841384957,-0.021961589549198055,0.01131513493957769,0.03241137210394476,-0.03644968012874727,0.007171933910412405,0.001729065409015146,-0.030995340759435407,0.006529475434561844,-0.00875185661611746,-0.008122509765812245,-0.0069031500105152365,-0.0317295806141034,0.01582545496475435,0.0018536236398047198,0.003526965571574761,-0.014186531108248508,-0.008738745456233423,0.012173931744466652,0.021410909658197058,-0.0020814341173263245,0.01048911696572144,-0.011013572674309118,0.003007426547943596,0.00966309899186519,0.014147196697273776,0.019483535627629306,-0.008030729783978745,0.003844917019529033,-0.004195646600024051,-0.0034941872062033592,-0.0022502433276318156,-0.01785772199968488,-0.028713957961417694,-0.009171422114310225,0.004149757074768613,0.004969219003021533,-0.002989398470272391,0.004320204947228953,-0.004284148791886541,0.02332517439152602,0.009689322242955885,-0.00284025623262361,-0.01737259977074931,-0.004497208865292622,-0.0029336748766119578,0.002047016856969418,-0.01750371323223492,-0.025186992622673588,0.006041075881316576,0.02537055258634059,-0.008129065345754263,-0.0036253011333502788,-0.0056083996889010855,-0.0014119335249689544,-0.021096236233044453,-0.013858745591889241,-0.007414494559218879,0.02690458436980627,0.04452630362893325,0.006526197644590835,0.00017659412155771333,0.03896707125525861,-0.000771523726057937,0.0013406403125309008,-0.011964149461031581,0.002248604432646311,0.012285378466126207,0.0017487324980871841,0.030444662731079656,0.01421275342801658,-0.02323339440969252,0.009918771266217012,0.006100077032117362,-0.010430115814920654,-0.023023612126257448,0.02479365037557152,-0.010108886809826028,-0.0033450449685545783,-0.0190770822206432,-0.004300538207402898,0.01712348400766213,-0.0010898848395509211,0.018369066548388522,0.00017628681419601524,0.006362304886411201,-0.009092753292360763,0.028058388791344407,-0.0009309091155737852,0.00568051246524722,-0.0027337261959205694,0.0064344176627573356,0.030549553872797192,-0.012613163051162848,-0.014173419017041848,0.0028451729175801234,-0.01981132021266595,0.0333816165618159,0.00797172863317796,-0.0007178489257523768,0.020899565109493416,0.009348425566712584,-0.024465865790534877,0.0022174649622604134,0.011433137241179262,-0.0016798976281273874,-0.015274776936398596,-0.011452804912327938,-0.008168399756728995,0.0043169271572579436,-0.008345404140453976,0.01062023135852967,-0.021056902753392344,0.0016446608038624005,-0.0010202305220983721,0.02968420055664359,-0.03170335456904484,0.03616123088600798,0.013989859984697473,0.03141490532630555,0.018146173105069417,-0.009138643283277511,-0.0082339564874718,0.02968420055664359,-0.023220283249808484,-0.03922929817822983,0.003027093520600306,-0.0008161844293202305,0.005732958036105987,-0.013019616458148956,-0.021948476526668773,0.00576245861150638,-0.02155513614221195,-0.0013537517052455927,0.02097823393144288,0.21670515466778614,-0.009276313256027761,0.0029156467989407526,0.030706889654050874,-0.001022688864576629,0.048774393937170826,0.017923279661750308,0.00021900128600727415,-0.00841096087119678,-0.008653521985664565,-0.010062996818909278,0.020480000542623274,-0.015287888096282632,0.002520665889683833,-0.004113700453764891,-0.024111857023084913,-0.02265649219892345,-0.02146335616037845,-0.0001801792625461684,-0.022040256508502273,0.005841126967794532,-0.011072573825109904,-0.0031106787946756274,-0.0058673497532239155,0.018552626512055522,0.0037531372705261893,-0.023220283249808484,-0.014160307857157812,0.013714520970519596,0.013753854450171707,0.008043841875185405,-0.01789705547933699,-0.008850192177892976,0.01746437975258281,-0.01615323954979099,0.0029336748766119578,0.019352420303498454,-0.0035958005579498856,-0.018395288868156594,-0.004995441788450917,0.015366556918232096,0.005542842958158282,-0.01092834920374026,0.01772660853819927,0.020912676269377452,0.029789091698361126,-0.014842100278321795,0.0006805634245478455,-0.014933880260155293,0.011937926209940886,-0.024347863488933304,-0.010934904783682278,0.04156312561578369,0.013583406577711366,-0.006483585443645094,0.007257157846642576,0.004362817148174694,0.0019650704778796015,-0.01617946373220431,-0.01953598026716545,-0.03419452337578811,0.014068527875324312,-0.010954571523508332,0.0018896800279777867,-0.018526402329642203,0.02281382984282238,-0.028766404463599085,0.01759549321406842,0.011636363944672315,-0.021489578480146522,-0.0020486557519549227,-0.00789306074255112,-0.013622740988686098,-0.010213777951543565,0.0003060691682710444,-0.016376134855755346,-0.002274827218075695,-0.017962613141402416,0.0304971073706158,0.01998176715380367,-0.002024071861511043,-0.014383202231799543,0.036869244695617406,0.016349910673342027,-0.010790679230990011,0.0034319080326009085,0.022512267577553806,-0.010941460363624296,0.005516620172728898,0.02011288247793452,-9.213828638475482e-05,-0.0100433291477606,0.011767478337480545,0.002995954050214409,0.024872319197520983,-0.006477029863703076,0.019129526860179345,0.02249915641766977,-0.01902463571846181,0.00033167736808086413,-0.005693623625131256,-0.028713957961417694,0.0012341101594125327,0.003998975942134327,-0.02440030812846945,-0.0048381050758746135,-0.009656543411923173,0.013963636733606778,0.00789306074255112,-0.02695703087198766,0.014356978980708847,0.002171574971343664,-0.0002587452024496421,-0.01798883546117049,0.0051527789666885315,0.010023662407934546,-0.011806812748455277,0.019863764852202096,-0.014422535711451651,-0.01804128196335188,-0.0036613575215233454,-0.018290397726439058,-0.011800256237190635,-0.015405890397884205,-0.013196620841873936,-0.021476467320262486,-0.014029194395672203,0.011583918373813546,0.009623764580890459,-0.02185669840748052,0.0034024074572005154,-0.04137956565211669,0.0016446608038624005,-0.01594345726635592,0.015287888096282632,0.022512267577553806,-0.012632830722311526,-0.013714520970519596,0.0003632266495246337,-0.0037170808823531226,0.012337824036984973,0.01364896330845417,0.0017208708176722955,0.020440667062971166,-0.005519897962699907,-0.011203688217918135,0.013544072166736634,-0.01222637731532542,-0.013583406577711366,-0.011020128254251136,-0.026760359748436626,-0.0003706018224785639,-0.011728143926505813,0.002995954050214409,0.01585167728452242,-0.017883944319452953,-0.027455264260807268,-0.021096236233044453,-0.0007743918504902338,0.017228375149379666,-0.028346838034083697,0.027193035475190804,0.00875185661611746,-0.03511231946883262,0.0029582587670558373,0.013386735454160331,-0.16614761318406246,0.01759549321406842,0.03435185729439655,-0.031100231901152943,0.027114368515886587,-0.018224840064373634,0.02534432840392727,0.018801742275142704,-0.015812343804870312,0.010299001422112422,0.020217773619652057,0.008909194260016386,-0.03933418745730212,-0.013465404276109793,-0.014291422249966044,0.015930346106471885,0.0064442514983316735,0.011898591798966154,0.024478976950418913,0.009250090004937065,0.01798883546117049,-0.026419464003515945,-0.004520153860750997,-0.011151242647059367,0.03372251044409134,0.001228373910547939,0.010292445842170404,0.019037746878345845,0.005378950199978649,-0.019798209052781915,-0.018670628813657095,-0.009813880124499475,0.0024518311361393643,-0.01627124371403781,-0.0037072472796094397,-0.007171933910412405,-0.002914007903955248,0.005024942829512621,0.005257670108406068,0.009938438006043066,0.012901614156547383,0.01313106317980851,0.03537454639180383,0.009138643283277511,0.008568297583773083,0.03065444501451473,0.014055416715440276,-0.019994880176332948,0.02114868273522584,-0.006057465296832933,0.022223816472169273,-0.024806761535455555,0.0008424072147496143,-0.0022977722135340698,-0.010449782554746708,0.024033190063780695,0.014501204533401115,0.002710781200462195,-0.007473495710019665,-0.004366094938145703,-0.020191549437238738,0.016323688353573954,0.0071653778648090765,-0.0154321136489749,-0.001043175517556747,-0.010154776800742778,-0.017975724301286453,0.020401333583319057,-0.02215826067274909,0.012619718631104867,-0.007519385700936415,0.006916261636060584,0.01840840002804063,0.0009915493941907313,0.00515933454663055,0.012586940731394776,-0.003533521384347435,0.003146735182848694,-0.013937414413838705,0.009151754443161547,-0.01105290708528385,0.03511231946883262,-0.01391119116274801,-0.010259667942460313,0.02567211485160916,0.008627298734573869,-0.02050622472503659,-0.020401333583319057,-0.015078105812847561,0.013026172038090974,0.010764455979899315,-0.015615672681319276,-0.012593496311336794,-0.00018786172830988072,0.007303047837559325,0.03309316359378612,0.034692754901962476,-0.019431089125447915,0.004920051687795086,-0.00641475045726997,-0.006765480503426299,-0.0101351091295941,-0.02488543035740502,0.012409936347669796,0.024374085808701377,0.005660845259759854,0.01547144805994963,0.008148733016902941,0.022826941002706415,-0.01865751765377306,0.00936153672659662,0.001152163896738044,0.0021306018982140836,-0.00012353393597554931,-0.0019486812951939004,-0.002181408574087347,-0.008587964323599137,-0.018211728904489598,-0.008509296432972298,-0.001565992447574249,0.06088932546215931,0.004523431650722006,-0.029238413670005372,-0.0034515750052576183,-0.02332517439152602,-0.017687273195901916,-0.1075134482001528,0.0059066841641986475,-0.029054853706338375,0.015327222507257364,-0.0036941358868947476,0.01309828528009842,-0.004779103925073827,0.011433137241179262,-0.004579155011551783,0.008889526588867708,-0.0035826889324045382,-0.021043791593508308,0.009374648817803278,0.006365583142043522,0.024256083507099804,-0.03026110276741266,-0.011203688217918135,-0.011203688217918135,-0.019391755645795806,0.0054117290310113616,-0.011826479488281331,-0.005277336848232122,0.00632624873106879,-0.008338847629189334,-0.012390269607843741,-0.007912727482377174,-0.015117440223822293,-0.0003027913200923714,0.01183303506822335,0.005474007971783157,-0.003579411142433529,-0.0019486812951939004,0.029631755917107445,-0.011682253935589065,-0.0008432266622423666,0.011715032766621777,-0.019522869107281415,-0.03752481759098118,0.04303160159982919,-0.03220158982050969,0.009623764580890459,0.002222381647216927,0.008679744305432637,0.002096184405026521,-0.01700548170606056,9.46991107313116e-05,-0.035584328675238905,0.014055416715440276,-0.011151242647059367,-0.009027196561617958,-0.017687273195901916,-0.026419464003515945,-0.02881884910313523,-0.010279334682286367,0.03663324009241426,-0.009912215686274994,0.012560717480304082,-0.0027435595658335966,-0.006126299817546746,0.02227626297435066,0.002115851610513887,-0.002897618488438891,0.011039795925399814,0.019103304540411273,-0.007571831271795183,-0.00931564673567987,-0.014107862286299044,-0.02387585241988177,0.006270525370239014,-0.024203637004918413,0.018788631115258667,0.016782586400096205,-0.009368092306538638,-0.0012185404242195839,-0.03367006580455519,0.025016543818890628,-0.020034213655985057,-0.030156211625695123,0.008830525438066922,-0.02430852814663595,-0.01326217757261674,-0.022931832144423948,0.02301050096637341,-0.029867760520310586,0.025986788276761767,0.008620743154631851,0.013242509901468063,-0.012246044055151475,0.012305045205952261,-0.025973675254232484,0.0200866582955212,0.024832983855223627,0.00178806667623126,-0.01551078153960174,-0.0189853022388097,0.03865239596746076,-0.0002327272788934463,0.00992532684615903,-0.005873905333165934,-0.0024174136429518022,0.009597542261122386,0.008096287446044173,-0.05900128491124367,0.03568922167960169,0.0016176185709402644,0.0010513701088995975,-0.012927836476315456,-0.01971954023083245,0.030392216228898268,-0.027193035475190804,0.0019404867038510499,0.042795596996626044,-0.014055416715440276,0.022944943304307984,0.023089169788322875,0.00850274085303028,-0.0471485803092264,-0.024544534612484337,-0.0029943151552289044,-0.0013447375499946622,0.0016708835892917846,0.01663836177872656,-0.020283329419072238,-0.0024780539215687484,-0.015366556918232096,0.018644406493889022,-0.0030975674019609353,-0.0021174905054993916,0.016533470637009023,0.015904123786703812,-0.012298489626010243,-0.02404630122366473,0.019798209052781915,-0.032594932067611763,0.0023321897067216323,0.0021601024736144763,-0.0048741616968783355,-0.00650325264913246,0.0016930090208420792,0.01520921927433317,0.015300999256166669,0.046833908746719034,0.009177977694252243,-0.002609167848715668,0.03102156307920348,-0.03865239596746076,-0.0051167223456848095,0.009689322242955885,-0.018054393123235916,0.013072062029007724,0.006876927225085853,-0.005972240894941452,0.019588426769346842,0.028294393394547552,0.008063508615011459,0.0009653265505536836,-0.005431395770837417,-0.019129526860179345,0.023390730190946202,-0.017018592865944596,-0.0028140334471942257,-0.037288812987778044,0.03220158982050969,-0.0032630988222954174,0.0013463765613954946,-0.00645736265821571,0.020742229328239735,-0.0020716005145826415,0.013380179874218313,0.004051421512993095,-0.010082663558735333,-0.01947042446774527,-0.016900590564343024,-0.004067810928509452,0.011308579359635671,0.012023150611832366,-0.00024768245757066283,0.01998176715380367,-0.018578848831823595,-0.0038645839921857433,-0.021043791593508308,-0.0100433291477606,0.00792583864226121,-0.0056706790953341924,-0.0410911164093774,0.008024174204036727,0.0200866582955212,0.006955595581374005,0.008122509765812245,0.00844373877090687,0.0028025609494650382,0.009505762279288886,-0.014383202231799543,0.020309553601485557,0.009643432252039136,0.006037798091345567,0.017661050876133844,0.027376595438857804,-0.018028170803467844,0.024478976950418913,0.005598566318988058,-0.007362048988360111,-0.01650724831724095,-0.0023829963825948955,-0.0034319080326009085,-0.013078617608949742,-0.02049311170250731,0.008587964323599137,-0.0002298591690130654,-0.03561055099500698,-0.0138718576830959,0.03571544399936976,0.015891012626819773,-0.004330038782803291,0.00827329089844653,0.0016766198381563784,-0.02110934739292849,0.026327684021682445,-0.002143713290928775,-0.027193035475190804,0.016389246015639382,0.02171247192346563,0.005982074730515791,0.02592123061469634,-0.007473495710019665,0.002900896511240556,0.021646916124045446,-0.00949265111940485,0.020925789291906735,-0.017018592865944596,0.005172445706514586,-0.007794725180775602,0.01859195999170763,0.004339872152716319,-0.009033752141559976,-0.0007190781551991691,0.004500486655263631,-0.0394390804616649,-0.00827329089844653,0.01978509789289788,-0.027009475511523804,0.03579411095867398,0.010502228125605476,-0.014186531108248508,0.026930808552219587,-0.02024399593942013,0.021607580781748095,-0.01850018000987413,-0.007598054057224567,-0.004877439486849345,-0.016848144062161632,0.01624501953162449,-0.00632624873106879,0.011197132637976117,-0.0025632780906295737,-0.02127979619671145,0.017792164337619452,0.01686125522204567,-0.0006281178536890776,-0.021437133840610377,-0.02336450787117813,0.01357029541782733,-0.03456163957783162,0.01730704397132913,-0.006844148859714451,0.003559744169776819,-0.004621767212497524,0.04662412646328397,-0.015327222507257364,0.008109398605928209,0.003128706872346833,0.0018962357243351327,-0.01798883546117049,-0.023902074739649844,-0.01391119116274801,0.029789091698361126,-0.01569434150326874,0.015445224808858937,-0.0133474010431856,0.011400359341469171,-0.00637213872198554,-0.009958105677191744,0.03047088505084773,-0.01460609567511865,-0.005693623625131256,0.004890550646733381,0.022997389806489375,-0.005926351369686013,-0.014737209136604259,0.001384071728138738
            ]

        data = [
            (vertex_id1, document_content1, int(time.time())),
            (vertex_id2, document_content2, int(time.time()))
        ]

        # Create the index
        milvus_embedding_store.add_embeddings(data)


    def test_retrieve_answer_integration(self):
        fp = open("configs/llm_config.json")
        test_llm_config = json.load(fp)
        embedding_service = OpenAI_Embedding(test_llm_config["embedding_service"])
        llm_service = OpenAI(test_llm_config["completion_service"])
        retriever = MilvusRetriever(embedding_service=embedding_service, llm_service=llm_service, milvus_embedding_store=milvus_embedding_store)

        # Perform a search/retrieval
        question = "Give all the character names"
        results = retriever.retrieve_answer(question=question, top_k=5)

        print("\n\n\nRetrieved the following embeddings")
        print(results)
        
        ids = []
        vector_ids = []

        for hits in results:
            for hit in hits:
                ids.append(hit.id)
                vector_ids.append(hit.entity.get(vertex_field))

        print(ids)
        print(vector_ids)
        self.assertEqual(len(ids), 2)
        self.assertEqual(len(vector_ids), 2)
        self.assertEqual(len(vector_ids), 2)
        self.assertEqual(vertex_id1 in set(vector_ids), True)
        self.assertEqual(vertex_id2 in set(vector_ids), True)

if __name__ == "__main__":
    unittest.main()