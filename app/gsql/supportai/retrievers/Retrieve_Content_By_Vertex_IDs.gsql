CREATE DISTRIBUTED QUERY Retrieve_Content_By_Vertex_IDs(SET<STRING> vertex_ids) {
  MapAccum<STRING, STRING> @@content_retrieval;

  SetAccum<VERTEX> @@vertex_set;

  docs = {Document.*};

  FOREACH vid IN vertex_ids DO
    STRING search_param = lower(vid);
    tmp = SELECT v FROM docs:v WHERE lower(v.id) LIKE search_param ACCUM @@vertex_set += v;
  END;
  
  v_set = @@vertex_set;
    
  content = SELECT v FROM v_set:v -(:e)- Content:c
        ACCUM @@content_retrieval += (v.id -> c.text);
  
  PRINT @@content_retrieval;
}